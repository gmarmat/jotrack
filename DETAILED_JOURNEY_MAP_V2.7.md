# Detailed Journey Map v2.7

**Complete User Journey with Technical Details**

---

## ğŸ¯ **THE COMPLETE DATA JOURNEY**

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          PHASE 1: DOCUMENT UPLOAD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ USER ACTION: Create Job & Upload Documents                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Navigate to homepage                                                   â”‚
â”‚  2. Click "Add New Job Application"                                       â”‚
â”‚  3. Enter: Title, Company, Status                                         â”‚
â”‚  4. Click "Create Job"                                                    â”‚
â”‚  5. Navigate to job page                                                  â”‚
â”‚  6. Click "Attachments" button (in header, second row)                   â”‚
â”‚  7. Upload files:                                                         â”‚
â”‚     â€¢ ğŸ“„ Resume.docx (350 KB)                                            â”‚
â”‚     â€¢ ğŸ’¼ JobDescription.pdf (125 KB)                                     â”‚
â”‚     â€¢ âœ‰ï¸ CoverLetter.docx (80 KB)                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš™ï¸ SYSTEM ACTIONS:                                                       â”‚
â”‚  â€¢ Validate file types (.docx, .pdf, .txt)                               â”‚
â”‚  â€¢ Check size limits (10 MB per file, 100 MB per job)                    â”‚
â”‚  â€¢ Generate UUID for each attachment                                      â”‚
â”‚  â€¢ Save to: /data/attachments/[jobId]/[uuid].[ext]                       â”‚
â”‚  â€¢ Insert records into 'attachments' table:                              â”‚
â”‚     - id, job_id, filename, path, size, kind, version,                  â”‚
â”‚       is_active, created_at                                              â”‚
â”‚  â€¢ Mark as active (is_active = true, version = 1)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ DATABASE STATE:                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ attachments table:                                               â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚ â”‚ id         â”‚ job_id  â”‚ filename â”‚ kind â”‚ version â”‚ active â”‚  â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚    â”‚
â”‚  â”‚ â”‚ 841d17ee.. â”‚ 3957... â”‚ Resume.. â”‚ resumeâ”‚   1    â”‚  true  â”‚  â”‚    â”‚
â”‚  â”‚ â”‚ 7f3a82bc.. â”‚ 3957... â”‚ JD.pdf   â”‚ jd   â”‚   1    â”‚  true  â”‚  â”‚    â”‚
â”‚  â”‚ â”‚ 9e2c55ab.. â”‚ 3957... â”‚ Cover..  â”‚ coverâ”‚   1    â”‚  true  â”‚  â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: FREE                                                            â”‚
â”‚  â±ï¸ TIME: ~1-2 seconds total                                              â”‚
â”‚  ğŸ“Š TOKENS: 0 (no AI used)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    PHASE 2: AUTO LOCAL TEXT EXTRACTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ SYSTEM ACTION: Background Text Extraction (Automatic)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Triggered: Immediately after each file upload                            â”‚
â”‚  Code: app/api/jobs/[id]/attachments/route.ts (POST handler)            â”‚
â”‚  Function: saveRawVariant() from lib/extraction/extractionEngine.ts     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”„ PROCESS FOR EACH FILE:                                                â”‚
â”‚                                                                           â”‚
â”‚  ğŸ“„ Resume.docx:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ 1. Detect file type: .docx                                â”‚          â”‚
â”‚  â”‚ 2. Call: mammoth.extractRawText({path: filePath})        â”‚          â”‚
â”‚  â”‚ 3. Get plain text: "John Smith\nSenior Product..."       â”‚          â”‚
â”‚  â”‚ 4. Count words: 2,450 words                              â”‚          â”‚
â”‚  â”‚ 5. Calculate contentHash: SHA-256(text)                  â”‚          â”‚
â”‚  â”‚    â†’ "a7f3c8e2b4d1..."                                   â”‚          â”‚
â”‚  â”‚ 6. Estimate tokens: ~2,500 tokens                        â”‚          â”‚
â”‚  â”‚ 7. Check if variant exists with same hash                â”‚          â”‚
â”‚  â”‚ 8. If new: Insert into artifact_variants table:          â”‚          â”‚
â”‚  â”‚    - source_id: 841d17ee... (attachment id)             â”‚          â”‚
â”‚  â”‚    - source_type: 'resume'                               â”‚          â”‚
â”‚  â”‚    - variant_type: 'raw'                                 â”‚          â”‚
â”‚  â”‚    - content: {text: "...", metadata: {wordCount: 2450}} â”‚          â”‚
â”‚  â”‚    - content_hash: "a7f3c8e2b4d1..."                    â”‚          â”‚
â”‚  â”‚    - token_count: 2500                                   â”‚          â”‚
â”‚  â”‚    - extraction_model: 'local'                           â”‚          â”‚
â”‚  â”‚    - is_active: true                                     â”‚          â”‚
â”‚  â”‚    - created_at: 1697123456789                           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                           â”‚
â”‚  ğŸ’¼ JD.pdf:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ 1. Detect file type: .pdf                                â”‚          â”‚
â”‚  â”‚ 2. Call: pdf-parse (dynamic import)                      â”‚          â”‚
â”‚  â”‚ 3. Get plain text: "We are seeking a Senior Product..."  â”‚          â”‚
â”‚  â”‚ 4. Count words: 825 words, 3 pages                       â”‚          â”‚
â”‚  â”‚ 5. Calculate contentHash: "b9e1f7a3c2..."               â”‚          â”‚
â”‚  â”‚ 6. Estimate tokens: ~850 tokens                          â”‚          â”‚
â”‚  â”‚ 7. Insert into artifact_variants (same process)          â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                           â”‚
â”‚  âœ‰ï¸ Cover.docx:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Same process as Resume.docx                               â”‚          â”‚
â”‚  â”‚ Word count: 512 words â†’ ~550 tokens                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ DATABASE STATE (After Extraction):                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ artifact_variants table:                                         â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚ â”‚ source_id  â”‚ source   â”‚variant â”‚ content  â”‚tokensâ”‚  hash   â”‚ â”‚    â”‚
â”‚  â”‚ â”‚            â”‚ _type    â”‚_type   â”‚          â”‚      â”‚         â”‚ â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚    â”‚
â”‚  â”‚ â”‚ 841d17ee.. â”‚ resume   â”‚ raw    â”‚ "John.." â”‚ 2500 â”‚ a7f3c8..â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ 7f3a82bc.. â”‚ job_desc â”‚ raw    â”‚ "We are" â”‚  850 â”‚ b9e1f7..â”‚ â”‚    â”‚
â”‚  â”‚ â”‚ 9e2c55ab.. â”‚ cover_le â”‚ raw    â”‚ "Dear.." â”‚  550 â”‚ c2d4e8..â”‚ â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: FREE (local computation only)                                   â”‚
â”‚  â±ï¸ TIME: ~500ms per file = ~1.5 seconds total                            â”‚
â”‚  ğŸ“Š TOKENS USED: 0 (no AI calls)                                          â”‚
â”‚  ğŸ“Š TOKENS STORED: 3,900 (raw text for all 3 files)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              PHASE 3: UI SHOWS "DATA PIPELINE STATUS" PANEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘ï¸ USER SEES: Purple Banner (Collapsible Panel)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â†“] ğŸ“„ Documents Ready Â· Click "Extract Data" to create AI-ready        â”‚
â”‚           variants from your uploads (~$0.02)                             â”‚
â”‚                                                                           â”‚
â”‚  Button: [Extract Data ~$0.02]  â† User clicks this                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“Š PANEL STATE:                                                          â”‚
â”‚  â€¢ severity: 'no_variants'                                               â”‚
â”‚  â€¢ isStale: true                                                         â”‚
â”‚  â€¢ hasVariants: false                                                    â”‚
â”‚  â€¢ hasAnalysis: false                                                    â”‚
â”‚  â€¢ message: "Documents uploaded - click Extract Data..."                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ USER CAN:                                                             â”‚
â”‚  â€¢ Click expand (â†“) to see uploaded documents list                       â”‚
â”‚  â€¢ Click "View Variants" â†’ See only 'raw' column (other 2 empty)        â”‚
â”‚  â€¢ Click "Extract Data" to start AI processing                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    PHASE 4: AI VARIANT EXTRACTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ USER ACTION: Click "Extract Data" Button                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Endpoint: POST /api/jobs/[id]/refresh-variants                      â”‚
â”‚  Code: app/api/jobs/[id]/refresh-variants/route.ts                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”„ SYSTEM PROCESS (For Each Document):                                   â”‚
â”‚                                                                           â”‚
â”‚  DOCUMENT 1/3: Resume                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Step 1: Fetch 'raw' variant from database                 â”‚         â”‚
â”‚  â”‚   SELECT * FROM artifact_variants                          â”‚         â”‚
â”‚  â”‚   WHERE source_id='841d17ee' AND variant_type='raw'       â”‚         â”‚
â”‚  â”‚   â†’ Get: {text: "John Smith\nSenior PM...", ...}          â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 2: Prepare AI extraction prompt                      â”‚         â”‚
â”‚  â”‚   Prompt: "Extract structured data from this resume..."   â”‚         â”‚
â”‚  â”‚   + Raw text (2,500 tokens)                               â”‚         â”‚
â”‚  â”‚   Total input: ~2,700 tokens                              â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 3: Call GPT-4o Mini API                              â”‚         â”‚
â”‚  â”‚   Model: gpt-4o-mini                                       â”‚         â”‚
â”‚  â”‚   Temperature: 0.3 (consistent structured output)         â”‚         â”‚
â”‚  â”‚   Max tokens: 2,000                                        â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 4: AI returns structured JSON                        â”‚         â”‚
â”‚  â”‚   {                                                        â”‚         â”‚
â”‚  â”‚     "name": "John Smith",                                 â”‚         â”‚
â”‚  â”‚     "role": "Senior Product Manager",                     â”‚         â”‚
â”‚  â”‚     "contact": {                                           â”‚         â”‚
â”‚  â”‚       "email": "john@example.com",                        â”‚         â”‚
â”‚  â”‚       "phone": "(555) 123-4567",                          â”‚         â”‚
â”‚  â”‚       "location": "San Francisco, CA"                     â”‚         â”‚
â”‚  â”‚     },                                                     â”‚         â”‚
â”‚  â”‚     "skills": [                                            â”‚         â”‚
â”‚  â”‚       "Product Management", "Agile", "SQL",               â”‚         â”‚
â”‚  â”‚       "Python", "Tableau", "User Research"                â”‚         â”‚
â”‚  â”‚     ],                                                     â”‚         â”‚
â”‚  â”‚     "experience": [                                        â”‚         â”‚
â”‚  â”‚       {                                                    â”‚         â”‚
â”‚  â”‚         "company": "Google Inc.",                          â”‚         â”‚
â”‚  â”‚         "role": "Senior Product Manager",                 â”‚         â”‚
â”‚  â”‚         "duration": "3 years",                            â”‚         â”‚
â”‚  â”‚         "dates": "2020-2023",                             â”‚         â”‚
â”‚  â”‚         "key_achievements": [                             â”‚         â”‚
â”‚  â”‚           "Launched search feature with 10M+ DAU",        â”‚         â”‚
â”‚  â”‚           "Increased engagement by 35%"                   â”‚         â”‚
â”‚  â”‚         ]                                                  â”‚         â”‚
â”‚  â”‚       }                                                    â”‚         â”‚
â”‚  â”‚     ],                                                     â”‚         â”‚
â”‚  â”‚     "education": {                                         â”‚         â”‚
â”‚  â”‚       "degree": "MBA",                                     â”‚         â”‚
â”‚  â”‚       "school": "Stanford University",                    â”‚         â”‚
â”‚  â”‚       "year": 2018                                         â”‚         â”‚
â”‚  â”‚     }                                                      â”‚         â”‚
â”‚  â”‚   }                                                        â”‚         â”‚
â”‚  â”‚   Output tokens: ~600 (compact version)                   â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 5: Create 'ai_optimized' variant                     â”‚         â”‚
â”‚  â”‚   â€¢ Remove unnecessary fields                             â”‚         â”‚
â”‚  â”‚   â€¢ Keep only essential data for prompts                  â”‚         â”‚
â”‚  â”‚   â€¢ Result: ~500 tokens (83% reduction!)                  â”‚         â”‚
â”‚  â”‚   â€¢ Store in artifact_variants:                           â”‚         â”‚
â”‚  â”‚     - source_id: 841d17ee...                              â”‚         â”‚
â”‚  â”‚     - variant_type: 'ai_optimized'                        â”‚         â”‚
â”‚  â”‚     - content: {compact JSON above}                       â”‚         â”‚
â”‚  â”‚     - token_count: 500                                    â”‚         â”‚
â”‚  â”‚     - content_hash: SHA-256(JSON)                         â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 6: Create 'detailed' variant                         â”‚         â”‚
â”‚  â”‚   â€¢ Include ALL extracted fields                          â”‚         â”‚
â”‚  â”‚   â€¢ Add extended metadata                                 â”‚         â”‚
â”‚  â”‚   â€¢ Result: ~1,500 tokens (full structured)               â”‚         â”‚
â”‚  â”‚   â€¢ Store in artifact_variants:                           â”‚         â”‚
â”‚  â”‚     - source_id: 841d17ee...                              â”‚         â”‚
â”‚  â”‚     - variant_type: 'detailed'                            â”‚         â”‚
â”‚  â”‚     - content: {extended JSON}                            â”‚         â”‚
â”‚  â”‚     - token_count: 1500                                   â”‚         â”‚
â”‚  â”‚                                                            â”‚         â”‚
â”‚  â”‚ Step 7: Compare with previous version (if exists)         â”‚         â”‚
â”‚  â”‚   â€¢ Fetch previous ai_optimized variant                   â”‚         â”‚
â”‚  â”‚   â€¢ Call AI for semantic comparison                       â”‚         â”‚
â”‚  â”‚   â€¢ Return: {similarity: 0.95, changes: [...],           â”‚         â”‚
â”‚  â”‚              significance: 'minor'}                       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                           â”‚
â”‚  SAME PROCESS FOR:                                                        â”‚
â”‚  â€¢ JD.pdf (input: 850 tokens â†’ ai_opt: 300, detailed: 900)              â”‚
â”‚  â€¢ Cover.docx (input: 550 tokens â†’ ai_opt: 200, detailed: 600)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ DATABASE STATE (After AI Extraction):                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ artifact_variants table now has 9 total records:            â”‚       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚       â”‚
â”‚  â”‚ â”‚ source_id  â”‚ source   â”‚ variant    â”‚ tokens â”‚   hash   â”‚ â”‚       â”‚
â”‚  â”‚ â”‚            â”‚ _type    â”‚ _type      â”‚        â”‚          â”‚ â”‚       â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚       â”‚
â”‚  â”‚ â”‚ 841d17ee.. â”‚ resume   â”‚ raw        â”‚  2500  â”‚ a7f3c8.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 841d17ee.. â”‚ resume   â”‚ ai_optimiz â”‚   500  â”‚ d4e8f2.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 841d17ee.. â”‚ resume   â”‚ detailed   â”‚  1500  â”‚ f9a2c5.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 7f3a82bc.. â”‚ job_desc â”‚ raw        â”‚   850  â”‚ b9e1f7.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 7f3a82bc.. â”‚ job_desc â”‚ ai_optimiz â”‚   300  â”‚ e3f7a9.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 7f3a82bc.. â”‚ job_desc â”‚ detailed   â”‚   900  â”‚ c1d5e9.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 9e2c55ab.. â”‚ cover_le â”‚ raw        â”‚   550  â”‚ c2d4e8.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 9e2c55ab.. â”‚ cover_le â”‚ ai_optimiz â”‚   200  â”‚ a8b3c7.. â”‚ â”‚       â”‚
â”‚  â”‚ â”‚ 9e2c55ab.. â”‚ cover_le â”‚ detailed   â”‚   600  â”‚ d2e6f1.. â”‚ â”‚       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST CALCULATION:                                                     â”‚
â”‚  Resume:  (2,700 in Ã— $0.15/1M) + (2,100 out Ã— $0.60/1M) = $0.0017      â”‚
â”‚  JD:      (1,050 in Ã— $0.15/1M) + (1,200 out Ã— $0.60/1M) = $0.0009      â”‚
â”‚  Cover:   (750 in Ã— $0.15/1M) + (800 out Ã— $0.60/1M) = $0.0006          â”‚
â”‚  Semantic Compare (Ã—3): ~$0.0018                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  TOTAL: ~$0.005 (about half a cent!)                                     â”‚
â”‚                                                                           â”‚
â”‚  â±ï¸ TIME: ~2-3 seconds per file = ~6-9 seconds total                      â”‚
â”‚  ğŸ“Š AI TOKENS USED: ~10,000 tokens (input + output + comparison)         â”‚
â”‚  ğŸ“Š TOKENS SAVED: Variants ready for reuse (no re-processing!)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           PHASE 5: UI UPDATES TO "DATA EXTRACTED - START ANALYSIS"
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘ï¸ USER SEES: Blue Banner (Data Pipeline Status Panel)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â†“] ğŸŒŸ Data Extracted - Start Analysis Â· AI variants ready Â· Scroll to â”‚
â”‚           sections below and trigger analysis for each (~$0.05-0.10)     â”‚
â”‚                                                                           â”‚
â”‚  [EXPANDED VIEW]                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ğŸ“ Input Documents (3)                                       â”‚       â”‚
â”‚  â”‚                                                               â”‚       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚ â”‚ ğŸ“„ Resume.docx â€¢ v1 â€¢ Active     â”‚ [View Variants]  â”‚    â”‚       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚ â”‚ ğŸ’¼ JD.pdf â€¢ v1 â€¢ Active          â”‚ [View Variants]  â”‚    â”‚       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚ â”‚ âœ‰ï¸ Cover.docx â€¢ v1                â”‚ [View Variants]  â”‚    â”‚       â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â”‚                                                               â”‚       â”‚
â”‚  â”‚ Ready: [ğŸ¯ Match] [ğŸ¢ Company] [ğŸŒ Ecosystem] [ğŸ‘¤ Profile]  â”‚       â”‚
â”‚  â”‚        â†‘ Click any badge to scroll to that section           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ USER ACTIONS AVAILABLE:                                               â”‚
â”‚  1. Click "View Variants" on any document                                â”‚
â”‚     â†’ Opens modal with 3 columns side-by-side:                          â”‚
â”‚       [ğŸ“„ Raw] [ğŸ¤– AI-Optimized] [ğŸ“‹ Detailed]                          â”‚
â”‚     â†’ Can verify extraction quality                                      â”‚
â”‚                                                                           â”‚
â”‚  2. Click any badge (ğŸ¯/ğŸ¢/ğŸŒ/ğŸ‘¤)                                       â”‚
â”‚     â†’ Smooth scroll to that section                                      â”‚
â”‚     â†’ Find "Analyze" button in section                                   â”‚
â”‚     â†’ Trigger analysis for that specific section                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              PHASE 6: INDIVIDUAL SECTION ANALYSIS (User Choice)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User scrolls to a section and clicks "Analyze" button.
Each section is independent, triggered separately.


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECTION 1: ğŸ¯ MATCH SCORE ANALYSIS                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User scrolls to Match section â†’ Clicks "Analyze Match Score" button       â”‚
â”‚  API: POST /api/jobs/[id]/analyze-match-score                              â”‚
â”‚  Prompt: prompts/matchScore.v1.md                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¥ INPUTS FETCHED:                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 1. Resume ai_optimized variant (500 tokens)                      â”‚     â”‚
â”‚  â”‚    SELECT content FROM artifact_variants                         â”‚     â”‚
â”‚  â”‚    WHERE source_id='841d17ee' AND variant_type='ai_optimized'  â”‚     â”‚
â”‚  â”‚    â†’ {"name":"John", "skills":[...], "experience":[...]}       â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 2. JD ai_optimized variant (300 tokens)                         â”‚     â”‚
â”‚  â”‚    SELECT content FROM artifact_variants                         â”‚     â”‚
â”‚  â”‚    WHERE source_id='7f3a82bc' AND variant_type='ai_optimized'  â”‚     â”‚
â”‚  â”‚    â†’ {"requirements":[...], "responsibilities":[...]}          â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 3. Company name from job record                                 â”‚     â”‚
â”‚  â”‚    â†’ "TechCorp Inc."                                            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¤– AI PROCESSING:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Input Assembly:                                                  â”‚     â”‚
â”‚  â”‚ â€¢ Load matchScore.v1.md prompt template                          â”‚     â”‚
â”‚  â”‚ â€¢ Replace {{resumeVariant}} with 500-token JSON                 â”‚     â”‚
â”‚  â”‚ â€¢ Replace {{jdVariant}} with 300-token JSON                     â”‚     â”‚
â”‚  â”‚ â€¢ Replace {{companyName}} with "TechCorp Inc."                  â”‚     â”‚
â”‚  â”‚ â€¢ Total prompt: ~1,200 tokens                                    â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ AI Call:                                                         â”‚     â”‚
â”‚  â”‚ â€¢ Model: GPT-4o Mini                                             â”‚     â”‚
â”‚  â”‚ â€¢ System: "You are an expert career advisor..."                 â”‚     â”‚
â”‚  â”‚ â€¢ User message: [assembled prompt]                              â”‚     â”‚
â”‚  â”‚ â€¢ Temperature: 0.3                                               â”‚     â”‚
â”‚  â”‚ â€¢ Max tokens: 4000                                               â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ AI Response (JSON):                                              â”‚     â”‚
â”‚  â”‚ {                                                                â”‚     â”‚
â”‚  â”‚   "overallScore": 0.85,                                         â”‚     â”‚
â”‚  â”‚   "categoryBreakdown": {                                        â”‚     â”‚
â”‚  â”‚     "technical": {"score": 0.82, "weight": 0.40},              â”‚     â”‚
â”‚  â”‚     "experience": {"score": 0.88, "weight": 0.35},             â”‚     â”‚
â”‚  â”‚     "softSkills": {"score": 0.85, "weight": 0.25}              â”‚     â”‚
â”‚  â”‚   },                                                            â”‚     â”‚
â”‚  â”‚   "topStrengths": [                                             â”‚     â”‚
â”‚  â”‚     "Strong React expertise (3 years) matches key requirement", â”‚     â”‚
â”‚  â”‚     "Proven startup experience aligns with company stage",      â”‚     â”‚
â”‚  â”‚     "Leadership experience (managed team of 5)"                 â”‚     â”‚
â”‚  â”‚   ],                                                            â”‚     â”‚
â”‚  â”‚   "topGaps": [                                                  â”‚     â”‚
â”‚  â”‚     "Limited PostgreSQL experience (1 year vs 3+ required)",    â”‚     â”‚
â”‚  â”‚     "No CI/CD pipeline experience mentioned",                   â”‚     â”‚
â”‚  â”‚     "Missing domain-specific regulatory knowledge"              â”‚     â”‚
â”‚  â”‚   ],                                                            â”‚     â”‚
â”‚  â”‚   "quickRecommendation": "Strong overall fit (85%). Highlight  â”‚     â”‚
â”‚  â”‚     React projects and startup adaptability. Address PostgreSQLâ”‚     â”‚
â”‚  â”‚     gap in cover letter or prepare learning plan.",            â”‚     â”‚
â”‚  â”‚   "confidence": 0.90                                            â”‚     â”‚
â”‚  â”‚ }                                                                â”‚     â”‚
â”‚  â”‚ Output: ~1,000 tokens                                            â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ’¾ STORAGE (TODO - Not Yet Implemented):                                  â”‚
â”‚  â€¢ Store in match_score_analysis table (future)                           â”‚
â”‚  â€¢ For now: Returned to UI directly                                       â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“º UI DISPLAY:                                                             â”‚
â”‚  â€¢ Match Score card shows: 85%                                             â”‚
â”‚  â€¢ Category breakdown chart renders                                       â”‚
â”‚  â€¢ Strengths/Gaps lists display                                           â”‚
â”‚  â€¢ Recommendation shown prominently                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: ~$0.05                                                            â”‚
â”‚  â±ï¸ TIME: ~3-5 seconds                                                      â”‚
â”‚  ğŸ“Š TOKENS: Input 1,200 + Output 1,000 = 2,200 total                       â”‚
â”‚  ğŸ’° SAVINGS: Would have been ~$0.18 without variants (500 vs 2,500 tokens!)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECTION 2: ğŸ¢ COMPANY INTELLIGENCE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User clicks [ğŸ¢ Company] badge â†’ Scrolls to Company section               â”‚
â”‚  User clicks "Analyze Company" button                                       â”‚
â”‚  API: POST /api/jobs/[id]/analyze-company                                  â”‚
â”‚  Prompt: prompts/company.v1.md                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¥ INPUTS:                                                                 â”‚
â”‚  â€¢ JD ai_optimized variant (300 tokens)                                    â”‚
â”‚  â€¢ Company name: "TechCorp Inc." (extracted from JD or job record)         â”‚
â”‚  â€¢ WEB SEARCH PERMISSION: âœ… GRANTED (up to 5 searches)                    â”‚
â”‚                                                                             â”‚
â”‚  ğŸŒ WEB RESEARCH PROCESS:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ AI performs up to 5 web searches:                               â”‚     â”‚
â”‚  â”‚ 1. Search: "TechCorp Inc company overview"                      â”‚     â”‚
â”‚  â”‚    â†’ Finds: techcorp.com/about                                  â”‚     â”‚
â”‚  â”‚    â†’ Extracts: Founded 2018, 250+ employees                     â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 2. Search: "TechCorp Inc funding news"                          â”‚     â”‚
â”‚  â”‚    â†’ Finds: TechCrunch article                                  â”‚     â”‚
â”‚  â”‚    â†’ Extracts: Series B $75M led by Sequoia                     â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 3. Search: "TechCorp Inc LinkedIn"                              â”‚     â”‚
â”‚  â”‚    â†’ Finds: linkedin.com/company/techcorp                       â”‚     â”‚
â”‚  â”‚    â†’ Extracts: 5,000+ employees, rapid growth                   â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 4. Search: "TechCorp Inc culture Glassdoor"                     â”‚     â”‚
â”‚  â”‚    â†’ Finds: Reviews mentioning fast-paced, innovative           â”‚     â”‚
â”‚  â”‚    â†’ Extracts: Culture values                                   â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 5. Search: "TechCorp Inc leadership team"                       â”‚     â”‚
â”‚  â”‚    â†’ Finds: CEO Jane Doe (ex-Google), CTO John Smith (ex-Meta) â”‚     â”‚
â”‚  â”‚    â†’ Extracts: Leadership backgrounds                           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¤– AI ANALYSIS:                                                            â”‚
â”‚  â€¢ Combines JD requirements with web research                              â”‚
â”‚  â€¢ Identifies: competitors, culture, leadership, key facts                 â”‚
â”‚  â€¢ Returns structured JSON (see prompt for full schema)                    â”‚
â”‚  â€¢ Output: ~2,000 tokens                                                   â”‚
â”‚                                                                             â”‚
â”‚  ğŸ’¾ STORAGE (TODO):                                                         â”‚
â”‚  â€¢ Store in company_intelligence table                                     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“º UI DISPLAY:                                                             â”‚
â”‚  â€¢ Company overview card                                                   â”‚
â”‚  â€¢ Key facts list                                                          â”‚
â”‚  â€¢ Culture & values                                                        â”‚
â”‚  â€¢ Leadership profiles                                                     â”‚
â”‚  â€¢ Competitor analysis                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: ~$0.10 (prompt $0.05 + web searches $0.05)                       â”‚
â”‚  â±ï¸ TIME: ~5-10 seconds (web searches add latency)                         â”‚
â”‚  ğŸ“Š TOKENS: ~3,500 total (input + searches + output)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECTION 3: ğŸŒ COMPANY ECOSYSTEM MATRIX                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User clicks [ğŸŒ Ecosystem] badge â†’ Clicks "Analyze Ecosystem"             â”‚
â”‚  API: POST /api/jobs/[id]/analyze-ecosystem                                â”‚
â”‚  Prompt: prompts/companyEcosystem.v1.md                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¥ INPUTS:                                                                 â”‚
â”‚  â€¢ JD ai_optimized variant (300 tokens)                                    â”‚
â”‚  â€¢ Company name: "TechCorp Inc."                                           â”‚
â”‚  â€¢ Company intelligence (optional, if Step 2 was run first)                â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¤– AI ANALYSIS:                                                            â”‚
â”‚  â€¢ Identifies 15-25 related companies                                      â”‚
â”‚  â€¢ Categorizes: direct/adjacent/upstream/downstream/complementary          â”‚
â”‚  â€¢ Scores relevance (0-100)                                                â”‚
â”‚  â€¢ Flags career opportunities                                              â”‚
â”‚  â€¢ Marks interview relevance                                               â”‚
â”‚  â€¢ Returns structured JSON with ecosystem matrix                           â”‚
â”‚  â€¢ Output: ~1,500 tokens                                                   â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“º UI DISPLAY:                                                             â”‚
â”‚  â€¢ Grid of related companies                                               â”‚
â”‚  â€¢ Color-coded by category                                                 â”‚
â”‚  â€¢ Relevance scores                                                        â”‚
â”‚  â€¢ Career opportunity indicators                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: ~$0.05                                                            â”‚
â”‚  â±ï¸ TIME: ~3-5 seconds                                                      â”‚
â”‚  ğŸ“Š TOKENS: ~2,500 total                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECTION 4: ğŸ‘¤ USER PROFILE BUILDING                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User clicks [ğŸ‘¤ Profile] badge â†’ Clicks "Analyze Profile"                 â”‚
â”‚  API: POST /api/jobs/[id]/analyze-user-profile                             â”‚
â”‚  Prompt: prompts/userProfile.v1.md                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¥ INPUTS:                                                                 â”‚
â”‚  â€¢ Resume ai_optimized variant (500 tokens)                                â”‚
â”‚  â€¢ JD ai_optimized variant (300 tokens)                                    â”‚
â”‚  â€¢ Existing global profile (if any)                                        â”‚
â”‚  â€¢ Match analysis results (optional, if Step 1 ran first)                  â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¤– AI ANALYSIS:                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ TWO PROFILES BUILT:                                              â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ A. JOB-SPECIFIC PROFILE:                                         â”‚     â”‚
â”‚  â”‚    â€¢ Key strengths for THIS role                                â”‚     â”‚
â”‚  â”‚    â€¢ Relevant achievements (filtered for THIS job)              â”‚     â”‚
â”‚  â”‚    â€¢ STAR stories (5-7 stories, 2-3 min each)                  â”‚     â”‚
â”‚  â”‚    â€¢ Skills categorized (strong/developing/missing)             â”‚     â”‚
â”‚  â”‚    â€¢ Gap closing plans (actionable steps)                       â”‚     â”‚
â”‚  â”‚    â€¢ Interview prep (topics, keywords)                          â”‚     â”‚
â”‚  â”‚    â€¢ Unique value props (what makes you stand out)              â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ B. GLOBAL INSIGHTS (for future jobs):                           â”‚     â”‚
â”‚  â”‚    â€¢ Generic skills (applicable to all PM roles)                â”‚     â”‚
â”‚  â”‚    â€¢ Universal achievements (10M DAU launch)                    â”‚     â”‚
â”‚  â”‚    â€¢ Career patterns (startup â†’ scale-up â†’ enterprise)          â”‚     â”‚
â”‚  â”‚    â€¢ Transferable experiences                                   â”‚     â”‚
â”‚  â”‚    â€¢ Marked: applicableToFutureJobs = true                      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ’¾ STORAGE:                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 1. Job-Specific Profile:                                         â”‚     â”‚
â”‚  â”‚    â€¢ Store in job_profiles table (TODO)                         â”‚     â”‚
â”‚  â”‚    â€¢ Linked to this job ID                                      â”‚     â”‚
â”‚  â”‚    â€¢ Versioned (can update as user improves resume)             â”‚     â”‚
â”‚  â”‚                                                                  â”‚     â”‚
â”‚  â”‚ 2. Global Profile Update:                                        â”‚     â”‚
â”‚  â”‚    â€¢ Fetch existing user_profile record (singleton)             â”‚     â”‚
â”‚  â”‚    â€¢ Merge new globalInsights                                   â”‚     â”‚
â”‚  â”‚    â€¢ Deduplicate (don't store same insight twice)               â”‚     â”‚
â”‚  â”‚    â€¢ Update version number                                      â”‚     â”‚
â”‚  â”‚    â€¢ Store back to user_profile table                           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“º UI DISPLAY:                                                             â”‚
â”‚  â€¢ Profile card in section                                                 â”‚
â”‚  â€¢ Available at: /profile page                                             â”‚
â”‚  â€¢ Shows: Skills, stories, gaps, recommendations                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: ~$0.05                                                            â”‚
â”‚  â±ï¸ TIME: ~4-6 seconds                                                      â”‚
â”‚  ğŸ“Š TOKENS: Input 1,300 + Output 2,000 = 3,300 total                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SECTION 5: ğŸ¯ MATCH MATRIX (50 Signals)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  User clicks "Analyze Match Matrix" button in Match section                â”‚
â”‚  API: POST /api/jobs/[id]/evaluate-signals (already exists!)               â”‚
â”‚  Prompt: prompts/matchSignals.v1.md                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¥ INPUTS:                                                                 â”‚
â”‚  â€¢ Resume ai_optimized (500 tokens)                                        â”‚
â”‚  â€¢ JD ai_optimized (300 tokens)                                            â”‚
â”‚  â€¢ 30 ATS Standard Signals (pre-defined)                                   â”‚
â”‚  â€¢ 20 Dynamic Signals (AI generates based on JD)                           â”‚
â”‚                                                                             â”‚
â”‚  ğŸ¤– AI PROCESSING:                                                          â”‚
â”‚  â€¢ Evaluates each of 50 signals                                            â”‚
â”‚  â€¢ Scores 0.0-1.0 for each signal                                          â”‚
â”‚  â€¢ Provides evidence from resume/JD                                        â”‚
â”‚  â€¢ Explains reasoning                                                      â”‚
â”‚  â€¢ Calculates category weights                                             â”‚
â”‚  â€¢ Computes overall score                                                  â”‚
â”‚  â€¢ Output: ~3,000 tokens (50 signals Ã— 60 tokens each)                    â”‚
â”‚                                                                             â”‚
â”‚  ğŸ’¾ STORAGE:                                                                â”‚
â”‚  â€¢ Already implemented: signal_evaluations table                           â”‚
â”‚  â€¢ Records inserted for each signal                                        â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“º UI DISPLAY:                                                             â”‚
â”‚  â€¢ FitTable component (expandable by category)                             â”‚
â”‚  â€¢ Shows all 50 signals with scores                                        â”‚
â”‚  â€¢ Color-coded icons (âš™ï¸ ATS, âœ¨ Dynamic)                                  â”‚
â”‚  â€¢ Evidence and reasoning per signal                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° COST: ~$0.08                                                            â”‚
â”‚  â±ï¸ TIME: ~5-8 seconds                                                      â”‚
â”‚  ğŸ“Š TOKENS: ~5,000 total                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                PHASE 7: ALL ANALYSIS COMPLETE - GREEN STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ SYSTEM UPDATES:                                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Update jobs table:                                                    â”‚
â”‚     UPDATE jobs SET                                                       â”‚
â”‚       analysis_state = 'fresh',                                           â”‚
â”‚       analysis_fingerprint = SHA-256(all_variant_hashes),                â”‚
â”‚       last_full_analysis_at = NOW()                                       â”‚
â”‚     WHERE id = [jobId]                                                    â”‚
â”‚                                                                           â”‚
â”‚  2. Staleness check returns:                                              â”‚
â”‚     {                                                                     â”‚
â”‚       "isStale": false,                                                   â”‚
â”‚       "severity": "fresh",                                                â”‚
â”‚       "message": "Analysis is up to date",                               â”‚
â”‚       "hasVariants": true,                                                â”‚
â”‚       "hasAnalysis": true                                                 â”‚
â”‚     }                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘ï¸ USER SEES: Green Banner                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â†“] âœ… Analysis Complete Â· All data and analysis current Â· System will  â”‚
â”‚           alert when significant changes detected                         â”‚
â”‚                                                                           â”‚
â”‚  [EXPANDED VIEW]                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ğŸ“ Input Documents (3)                                       â”‚       â”‚
â”‚  â”‚ [ğŸ“„ Resume] [ğŸ’¼ JD] [âœ‰ï¸ Cover] with [View Variants] buttons â”‚       â”‚
â”‚  â”‚                                                               â”‚       â”‚
â”‚  â”‚ Ready: [ğŸ¯ Match] [ğŸ¢ Company] [ğŸŒ Ecosystem] [ğŸ‘¤ Profile]  â”‚       â”‚
â”‚  â”‚        â†‘ Click to jump to that section's results             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¡ USER CAN NOW:                                                         â”‚
â”‚  â€¢ View all analysis results                                             â”‚
â”‚  â€¢ Click badges to navigate to sections                                  â”‚
â”‚  â€¢ View variants (3-column comparison)                                   â”‚
â”‚  â€¢ Edit notes                                                            â”‚
â”‚  â€¢ Upload new document version â†’ Orange banner â†’ Re-extract              â”‚
â”‚  â€¢ Navigate to /profile to see global insights                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           PHASE 8: DOCUMENT UPDATE & CHANGE DETECTION (Optional)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ USER ACTION: Upload Updated Resume (v2)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Click "Attachments" button in header                                  â”‚
â”‚  2. Upload Resume_v2.docx                                                â”‚
â”‚  3. System creates new attachment record (version = 2)                    â”‚
â”‚  4. System extracts 'raw' variant (auto background)                       â”‚
â”‚  5. Triggers SQL trigger on attachments table                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš™ï¸ DATABASE TRIGGER FIRES:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Trigger: staleness_on_attachment_update                          â”‚    â”‚
â”‚  â”‚                                                                  â”‚    â”‚
â”‚  â”‚ UPDATE jobs                                                      â”‚    â”‚
â”‚  â”‚ SET analysis_state = 'stale'                                    â”‚    â”‚
â”‚  â”‚ WHERE id = [jobId]                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘ï¸ USER SEES: Orange Banner                                              â”‚
â”‚  [â†“] âš ï¸ Documents Changed Â· Documents updated Â· Click "Extract Data"     â”‚
â”‚           to refresh AI variants before analyzing                         â”‚
â”‚                                                                           â”‚
â”‚  Buttons: [Extract Data ~$0.02] (highlighted)                            â”‚
â”‚                                                                           â”‚
â”‚  User clicks â†’ Returns to Phase 4 (AI extraction)                        â”‚
â”‚  â†’ New variants created with contentHash                                 â”‚
â”‚  â†’ AI compares old vs new                                                â”‚
â”‚  â†’ Shows changelog: "Added 3 skills: AWS, Docker, K8s"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         TOTAL COST & TIME SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPLETE ANALYSIS (All Sections)                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Phase 1: Upload                           FREE        Instant            â”‚
â”‚  Phase 2: Local Extract (raw)              FREE        ~1.5s              â”‚
â”‚  Phase 3: UI Update                        FREE        Instant            â”‚
â”‚  Phase 4: AI Extract (variants)            $0.02       ~6-9s              â”‚
â”‚  Phase 5: UI Update (blue banner)          FREE        Instant            â”‚
â”‚  Phase 6a: Match Score                     $0.05       ~4s                â”‚
â”‚  Phase 6b: Company Intel                   $0.10       ~8s                â”‚
â”‚  Phase 6c: Ecosystem                       $0.05       ~4s                â”‚
â”‚  Phase 6d: User Profile                    $0.05       ~5s                â”‚
â”‚  Phase 6e: Match Matrix                    $0.08       ~7s                â”‚
â”‚  Phase 7: UI Update (green banner)         FREE        Instant            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  GRAND TOTAL:                             ~$0.35      ~45-55 seconds      â”‚
â”‚                                                                           â”‚
â”‚  vs. OLD WAY (without variants):          ~$1.50      ~60-90 seconds      â”‚
â”‚                                                                           â”‚
â”‚  SAVINGS:                                77% cost      20% time faster    â”‚
â”‚                                         reduction!                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                      TOKEN FLOW & REUSE VISUALIZATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚   RESUME            â”‚
                         â”‚   (Original File)   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                               â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ raw              â”‚          â”‚ (File stored)    â”‚
          â”‚ 2,500 tokens     â”‚          â”‚ /data/attachmentsâ”‚
          â”‚ FREE to create   â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚ $0.01 AI call
                    â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                                     â”‚
          â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ai_optimized     â”‚              â”‚ detailed         â”‚
â”‚ 500 tokens       â”‚              â”‚ 1,500 tokens     â”‚
â”‚ (Compact)        â”‚              â”‚ (Complete)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                  â”‚
          â”‚ REUSED IN:                       â”‚ USED FOR:
          â”œâ”€â†’ Match Score                    â”œâ”€â†’ Job Profile
          â”œâ”€â†’ Match Matrix                   â”œâ”€â†’ Global Profile
          â”œâ”€â†’ Company Intel (JD)             â”œâ”€â†’ Future Data Mining
          â”œâ”€â†’ Ecosystem (JD)                 â””â”€â†’ Extended Analysis
          â””â”€â†’ User Profile
          
          5 sections Ã— 500 tokens = 2,500 tokens TOTAL
          
          vs. WITHOUT variants:
          5 sections Ã— 2,500 tokens = 12,500 tokens
          
          SAVINGS: 10,000 tokens = ~$0.75! ğŸ’°
```

---

## ğŸ¯ **KEY TECHNICAL DECISIONS**

### **1. Why 3 Variants?**
```
raw (2,500 tok)     â†’ Backup, debugging, re-extraction
ai_optimized (500)  â†’ Used in ALL prompts, SAVES MONEY
detailed (1,500)    â†’ Profile building, future features
```

### **2. When Does Analysis Run?**
```
âŒ NOT automatic after "Extract Data"
âœ… User triggers EACH section individually
Why: User control, cost transparency, flexibility
```

### **3. Change Detection Strategy:**
```
Content-based (SHA-256 hash):
â€¢ Hash ai_optimized variant content
â€¢ Compare with previous hash
â€¢ If different â†’ Orange banner
â€¢ SQL triggers auto-detect changes
```

### **4. Profile Accumulation:**
```
Job-Specific:      Stored per job, role-tailored
Global Insights:   Merged to singleton, deduplicated
Why Both:          Specific prep + reusable knowledge
```

---

**This is the complete, accurate, detailed journey map!** ğŸ‰

